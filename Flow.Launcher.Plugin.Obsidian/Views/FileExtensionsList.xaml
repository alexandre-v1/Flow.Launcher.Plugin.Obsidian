<UserControl
    x:Class="Flow.Launcher.Plugin.Obsidian.Views.FileExtensionsList"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="http://schemas.modernwpf.com/2019"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="clr-namespace:Flow.Launcher.Plugin.Obsidian.ViewModels"
    d:DataContext="{d:DesignInstance viewModels:FileExtensionsListViewModel}"
    d:DesignWidth="600"
    mc:Ignorable="d">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Style.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>


    <StackPanel>
        <ItemsControl
            Margin="0"
            Padding="0"
            Background="Transparent"
            ItemsSource="{Binding FileExtensions}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border Name="Border" Style="{StaticResource SettingGroupBox}">
                        <DockPanel LastChildFill="False">
                            <TextBlock
                                Margin="20,0,0,0"
                                VerticalAlignment="Center"
                                DockPanel.Dock="Left"
                                Style="{StaticResource PageTitle}"
                                Text="{Binding Name}" />
                            <controls:ToggleSwitch
                                Margin="0,0,16,0"
                                DockPanel.Dock="Right"
                                IsOn="{Binding IsActive}"
                                OffContent="{DynamicResource disable}"
                                OnContent="{DynamicResource enable}" />
                            <TextBlock
                                Margin="0,0,16,0"
                                VerticalAlignment="Center"
                                DockPanel.Dock="Right"
                                Style="{StaticResource PageTitle}"
                                Text="{Binding Suffix}"
                                TextAlignment="Right" />
                        </DockPanel>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <ItemsControl
            Background="Transparent"
            ItemsSource="{Binding FileExtensionGroups}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border
                        Style="{StaticResource SettingGroupBox}"
                        Padding="0">
                        <Expander
                            BorderThickness="0"
                            ClipToBounds="True"
                            IsExpanded="False"
                            SnapsToDevicePixels="True"
                            Padding="0"
                            Margin="0"
                            Style="{DynamicResource ExpanderStyle1}">
                            <Expander.Header>
                                <!--  Negative left margin to nullify expander  -->
                                <Border Margin="-18,0,0,0" Padding="0, 15">
                                    <DockPanel
                                        HorizontalAlignment="{Binding HorizontalAlignment, RelativeSource={RelativeSource AncestorType=ContentPresenter}, Mode=OneWayToSource}"
                                        LastChildFill="False">
                                        <TextBlock
                                            Margin="20,0,0,0"
                                            VerticalAlignment="Center"
                                            DockPanel.Dock="Left"
                                            Style="{StaticResource PageTitle}"
                                            Text="{Binding Name}" />
                                        <controls:ToggleSwitch
                                            Margin="0,0,16,0"
                                            DockPanel.Dock="Right"
                                            IsOn="{Binding IsActive}"
                                            OffContent="{DynamicResource disable}"
                                            OnContent="{DynamicResource enable}" />
                                        <TextBlock
                                            Margin="0,0,16,0"
                                            VerticalAlignment="Center"
                                            DockPanel.Dock="Right"
                                            Style="{StaticResource PageTitle}"
                                            Text="{Binding FileExtensions.Count}"
                                            TextAlignment="Right" />
                                    </DockPanel>
                                </Border>
                            </Expander.Header>
                            <ItemsControl
                                Name="ItemsControl"
                                Margin="0"
                                Background="Transparent"
                                ItemsSource="{Binding FileExtensions}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border
                                            Padding="0 15"
                                            BorderBrush="{DynamicResource Color03B}"
                                            BorderThickness="0,1,0,0">
                                            <DockPanel LastChildFill="False">
                                                <TextBlock
                                                    Margin="20,0,0,0"
                                                    VerticalAlignment="Center"
                                                    DockPanel.Dock="Left"
                                                    Style="{StaticResource PageTitle}"
                                                    Text="{Binding Name}" />
                                                <controls:ToggleSwitch
                                                    Margin="0,0,16,0"
                                                    DockPanel.Dock="Right"
                                                    IsOn="{Binding IsActive}"
                                                    OffContent="{DynamicResource disable}"
                                                    OnContent="{DynamicResource enable}"
                                                    IsEnabled="{Binding DataContext.IsActive, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
                                                <TextBlock
                                                    Margin="0,0,16,0"
                                                    VerticalAlignment="Center"
                                                    DockPanel.Dock="Right"
                                                    Style="{StaticResource PageTitle}"
                                                    Text="{Binding Suffix}"
                                                    TextAlignment="Right" />
                                            </DockPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Expander>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </StackPanel>
</UserControl>
